# Описание API
Здесь описано всё АПИ, используемое в приложении, с описанием структур данных

## 1. Общее
### 1.1. Адрес сервера
Задаётся в src/config.ts

Выводится в консоль при запуске.

### 1.2. Как работать с сервером в терминале **Visual Studio Code**
* Первый запуск:
    1. `cd backend test-server`
    2. `npm install`
    3. `npm run dev`
* Выключение:
    1. Сочетание клавишь: `Ctrl` + `C`
    2. `Y`

| Команда | Описание |
| - | - |
| `npm run build` | создаёт билд сервера |
| `npm start` | запускает билд |
| `npm run dev` | создаёт билд, а потом запускает его |

### 1.3. Используемый протокол
API полностью реализовано на http(s). 

Формат возвращаемых значений `JSON`.

## 2. Структуры данных
### 2.1. Общий формат ответа
В случае успешного ответа возвращается `result = 'ok'` и поле `data` с данными.

В случае ошибки возвращается `result = 'error'` и поле `error` с кодом и текстом ошибки
```
Answer:{
    "result": "ok" | "error",
    "data"?: {
        "text": "text from back, db, neuro"   // базовый текст, который видит пользователь
        "buttons": [ // кнопки, которые бот получает по контексту от сервера
            {
                "action": {
                    "type": "callback",
                    "payload": "tag", // это информация, которая обработается ботом внутри, 
                                      //пользак её не видит, то есть здесь должен быть полный tag как в бд
                    "label": "tag_text" // текст из тэга, каторый увидит пользователь
                },
                "color": "primary"
            },
            ...
        ]
    },
    "error"?: {      // только когда ошибка
        "code": "error_code",
        "text": "error_text"
    }
}
```

### 2.3. Формат запроса
```
Request {
    "user_id": "user_id"
    "type": "text" || "tag", // text - текст вопроса пользователя, tag - если пользак нажал на кнопку с тэгом
    "text": "text" || "tag_text" // соответствующий текст вопроса пользователя или строгий tag вопроса,              
                                 // по которому потом он обратится бд        
}
```